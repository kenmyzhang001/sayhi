import{c as A,d as D,s as j,g as R}from"./api-yxYnz0nW.js";import{_ as S,r as x,q as z,d as u,c as w,o as v,b as a,e as V,w as l,g as K,h as y,k as h,t as F,E as s,s as G,a as H,j as J}from"./index-D4QNA_yb.js";const L={class:"position-value-editor"},O={class:"add-value-form"},Q={class:"values-list"},W={key:1},X={class:"batch-edit",style:{"margin-top":"20px"}},Y={style:{"margin-top":"10px"}},Z={__name:"PositionValueEditor",props:{position:{type:String,required:!0},values:{type:Array,default:()=>[]}},emits:["update"],setup(P,{emit:k}){const n=P,r=k,g=x(""),p=x(""),c=x([]),i=()=>{c.value=n.values.map((t,e)=>({value:t,editValue:t,editing:!1,index:e}))};z(()=>n.values,()=>{i()},{immediate:!0,deep:!0});const d=async()=>{const t=g.value.trim();if(!t){s.warning("请输入值");return}try{await A({position:n.position,value:t}),s.success("添加成功"),g.value="",r("update",n.position,null)}catch(e){s.error("添加失败: "+e.message)}},B=t=>{t.editing=!0,t.editValue=t.value},m=async t=>{if(!t.editValue.trim()){s.warning("值不能为空");return}const e=t.value,f=t.editValue.trim();if(e===f){t.editing=!1;return}try{await D(n.position,e),await A({position:n.position,value:f}),t.value=f,t.editing=!1,s.success("保存成功"),r("update",n.position,null)}catch(_){s.error("保存失败: "+_.message)}},$=async t=>{try{await G.confirm(`确定要删除值 "${t.value}" 吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await D(n.position,t.value),s.success("删除成功"),r("update",n.position,null)}catch(e){e!=="cancel"&&s.error("删除失败: "+e.message)}},U=async()=>{if(!p.value.trim()){s.warning("请输入要设置的值");return}const t=p.value.split(`
`).map(e=>e.trim()).filter(e=>e.length>0);if(t.length===0){s.warning("没有有效的值");return}try{await j(n.position,t),s.success(`批量设置成功，共 ${t.length} 个值`),p.value="",r("update",n.position,t)}catch(e){s.error("批量设置失败: "+e.message)}};return(t,e)=>{const f=u("el-input"),_=u("el-button"),E=u("el-form-item"),M=u("el-form"),N=u("el-divider"),q=u("el-empty"),T=u("el-table-column"),I=u("el-table");return v(),w("div",L,[a(M,null,{default:l(()=>[a(E,{label:"添加新值"},{default:l(()=>[V("div",O,[a(f,{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=o=>g.value=o),placeholder:"请输入位置值",style:{width:"300px","margin-right":"10px"},onKeyup:K(d,["enter"])},null,8,["modelValue"]),a(_,{type:"primary",onClick:d},{default:l(()=>[...e[3]||(e[3]=[y("添加",-1)])]),_:1})])]),_:1})]),_:1}),a(N),V("div",Q,[c.value.length===0?(v(),h(q,{key:0,description:"暂无配置值"})):(v(),h(I,{key:1,data:c.value,stripe:"",style:{width:"100%"}},{default:l(()=>[a(T,{prop:"value",label:"值","min-width":"200"},{default:l(({row:o})=>[o.editing?(v(),h(f,{key:0,modelValue:o.editValue,"onUpdate:modelValue":b=>o.editValue=b,onBlur:b=>m(o),onKeyup:K(b=>m(o),["enter"]),autofocus:""},null,8,["modelValue","onUpdate:modelValue","onBlur","onKeyup"])):(v(),w("span",W,F(o.value),1))]),_:1}),a(T,{label:"操作",width:"150",align:"center"},{default:l(({row:o})=>[o.editing?(v(),h(_,{key:1,link:"",type:"success",onClick:b=>m(o)},{default:l(()=>[...e[5]||(e[5]=[y(" 保存 ",-1)])]),_:1},8,["onClick"])):(v(),h(_,{key:0,link:"",type:"primary",onClick:b=>B(o)},{default:l(()=>[...e[4]||(e[4]=[y(" 编辑 ",-1)])]),_:1},8,["onClick"])),a(_,{link:"",type:"danger",onClick:b=>$(o)},{default:l(()=>[...e[6]||(e[6]=[y(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]))]),V("div",X,[a(E,{label:"批量设置"},{default:l(()=>[a(f,{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=o=>p.value=o),type:"textarea",rows:5,placeholder:"每行一个值，用于批量设置",style:{width:"500px"}},null,8,["modelValue"]),V("div",Y,[a(_,{type:"primary",onClick:U},{default:l(()=>[...e[7]||(e[7]=[y("批量设置",-1)])]),_:1}),a(_,{onClick:e[2]||(e[2]=o=>p.value="")},{default:l(()=>[...e[8]||(e[8]=[y("清空",-1)])]),_:1})])]),_:1})])])}}},C=S(Z,[["__scopeId","data-v-a2bf4052"]]),ee={class:"position-config"},te={class:"card-header"},ae={__name:"PositionConfig",setup(P){const k=x("a"),n=H({a:[],b:[],c:[],d:[]}),r=async()=>{try{const i=await R();i.positions&&(n.a=i.positions.a||[],n.b=i.positions.b||[],n.c=i.positions.c||[],n.d=i.positions.d||[])}catch(i){s.error("加载配置失败: "+i.message)}},g=()=>{r(),s.success("刷新成功")},p=()=>{},c=async(i,d)=>{n[i]=d,await r()};return J(()=>{r()}),(i,d)=>{const B=u("el-button"),m=u("el-tab-pane"),$=u("el-tabs"),U=u("el-card");return v(),w("div",ee,[a(U,null,{header:l(()=>[V("div",te,[d[2]||(d[2]=V("span",null,"位置值配置",-1)),a(B,{type:"primary",onClick:g},{default:l(()=>[...d[1]||(d[1]=[y("刷新",-1)])]),_:1})])]),default:l(()=>[a($,{modelValue:k.value,"onUpdate:modelValue":d[0]||(d[0]=t=>k.value=t),onTabChange:p},{default:l(()=>[a(m,{label:"位置 A",name:"a"},{default:l(()=>[a(C,{position:"a",values:n.a,onUpdate:c},null,8,["values"])]),_:1}),a(m,{label:"位置 B",name:"b"},{default:l(()=>[a(C,{position:"b",values:n.b,onUpdate:c},null,8,["values"])]),_:1}),a(m,{label:"位置 C",name:"c"},{default:l(()=>[a(C,{position:"c",values:n.c,onUpdate:c},null,8,["values"])]),_:1}),a(m,{label:"位置 D",name:"d"},{default:l(()=>[a(C,{position:"d",values:n.d,onUpdate:c},null,8,["values"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])}}},oe=S(ae,[["__scopeId","data-v-92f3bef8"]]);export{oe as default};
